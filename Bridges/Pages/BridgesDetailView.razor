@page "/bridgesdetailview/{name}"

@inject IBridgesService bridgesService;

@using BridgesDomain.Model
@using Bridges.Interfaces
@using Microsoft.AspNetCore.Http

<form method="post">
    @{
        Bridge bridge = bridgesService.GetBridge(Name);

        //bridge.Name = $"Updated bridge at {DateTime.Now:yyyyMMddhh:mm}";

        //bridgesService.Update(bridge);

        if (bridge != null)
        {
            var lat = @bridge.Lat;
            var lng = @bridge.Lng;
            var zoom = @bridge.Zoom;
            var height = @bridge.Height;
            var satParams = "!3m1!1e3";
            var url = $"https://www.google.co.uk/maps/@{lat},{lng},{height}m/data={satParams}";

            <table class="table" style="background-color: lightgoldenrodyellow; color: darkslategray; width: 100%; opacity: 0.6">
            <hr />
            <tr>
                <td colspan="2" style="text-align: left; background-color: darkslategray; opacity: 0.6; color: white">
                    <h6 style="color: whitesmoke">@bridge.Name<a href=@url> Show in maps</a></h6>
                </td>
            </tr>
            <tr>
                <td style="background-color: lightgoldenrodyellow">
                    <a href="@url">
                        <img alt="No image found for bridge with name: @bridge.Name" height="600" width="800" src="Images/Original/@bridge.Filename" />
                    </a>
                </td>
                <td style="horiz-align: left; vertical-align: text-top; background-color: lightgoldenrodyellow; opacity: 0.6; color: darkslategray; width: 100%">
                    <h6>Description</h6><a href=@url> Show in maps</a>
                    <hr />
                    <p>@bridge.Description</p>
                    <hr />
                    <p>Lng: @bridge.Lng.ToString("#.#######")</p>
                    <p>Lat: @bridge.Lat.ToString("#.#######")</p>
                    <p>Zoom (for google maps) :@bridge.Zoom.ToString("#.##")</p>
                    <p>Height (for google maps) :@bridge.Height.ToString("#.##")</p>
                </td>
            </tr>
            @*<tr>
                <td colspan="2" style="text-align: right; background-color: darkslategray; opacity: 0.6; color: white">
                    Actions:
                    <button>Edit</button>
                    <button>Save</button>
                </td>
            </tr>*@
            <tr>
                <td colspan="2" style="text-align: right; background-color: darkslategray; opacity: 0.6; color: white">
                    Actions:
                    <div class="form-group">
                        <input type="submit" value="Edit" class="btn btn-default" />
                        @*<input type="submit" value="@{
                                                        bridgesService.Update(bridge);
                                                    }" class="btn btn-default" />*@
                    </div>
                </td>
            </tr>
        </table>
        }
        else
        {
            <p>No bridge found for:[@Name]</p>
        }
    }
</form>

@code
{
    [Parameter]
    public string Name { get; set; }

    public void OnPost()
    {
        //var emailAddress = Request.Form["emailaddress"];
    }
}
